{"paragraphs":[{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1627233855472_923108191","id":"20210725-172415_965015321","dateCreated":"2021-07-25T17:24:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:713","text":"val taxiFactsPath = \"/user/otus/hw3/yellow_taxi_jan_25_2018/\"","dateUpdated":"2021-07-25T17:25:40+0000","dateFinished":"2021-07-25T17:25:40+0000","dateStarted":"2021-07-25T17:25:40+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"taxiFactsPath: String = /user/otus/hw3/yellow_taxi_jan_25_2018/\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1627233728993_-740322063","id":"20210725-172208_579085703","dateCreated":"2021-07-25T17:22:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:277","text":"// reading facts data\nval taxiFactsRDD = spark.read.parquet(taxiFactsPath).rdd","dateUpdated":"2021-07-25T17:25:40+0000","dateFinished":"2021-07-25T17:25:41+0000","dateStarted":"2021-07-25T17:25:40+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"taxiFactsRDD: org.apache.spark.rdd.RDD[org.apache.spark.sql.Row] = MapPartitionsRDD[23] at rdd at <console>:26\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1627233749841_-1541499660","id":"20210725-172229_772212627","dateCreated":"2021-07-25T17:22:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:354","text":"// grouping to show the most frequent order time, it could be grouped like day hour -> number of entries in our fact table\nval mostFrequentOrderTimes = taxiFactsRDD\n// creating RDD with one column -- hour value of the order (0-23)\n.map(\n  row => Integer.valueOf(row(1).toString.split(\" \")(1).split(\":\")(0)))\n// grouping RDDs by hour value\n.groupBy(\n    el => el)\n// making a map (list of entries where each entry has a first unique key value) with hour as a key and number of orders as a value\n.mapValues(\n  l => l.size)\n// sorting the result by number of orders in descending order\n.sortBy(_._2, ascending = false)","dateUpdated":"2021-07-25T17:25:41+0000","dateFinished":"2021-07-25T17:25:43+0000","dateStarted":"2021-07-25T17:25:41+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"mostFrequentOrderTimes: org.apache.spark.rdd.RDD[(Integer, Int)] = MapPartitionsRDD[32] at sortBy at <console>:37\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1627233782027_-27417326","id":"20210725-172302_208045059","dateCreated":"2021-07-25T17:23:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:429","text":"// creating a final table RDD\nval tableRDD = mostFrequentOrderTimes.map(r => r._1 + \" \" + r._2)","dateUpdated":"2021-07-25T17:25:43+0000","dateFinished":"2021-07-25T17:25:44+0000","dateStarted":"2021-07-25T17:25:43+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"tableRDD: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[33] at map at <console>:26\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1627233797136_1387277883","id":"20210725-172317_1357666259","dateCreated":"2021-07-25T17:23:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:501","text":"println(tableRDD.collect().mkString(\"\\n\"))","dateUpdated":"2021-07-25T17:25:44+0000","dateFinished":"2021-07-25T17:25:44+0000","dateStarted":"2021-07-25T17:25:44+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"16 22121\n17 21598\n19 20884\n18 20318\n20 19528\n6 18867\n15 18664\n13 17843\n12 17483\n7 16840\n14 16160\n11 16082\n10 16001\n9 15564\n5 15445\n8 15348\n21 14652\n4 8600\n22 7050\n23 3978\n3 3133\n0 2538\n1 1610\n2 1586\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1627233880384_1747979327","id":"20210725-172440_1689616498","dateCreated":"2021-07-25T17:24:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:905","text":"tableRDD.saveAsTextFile(\"most_frequent_order_times\")","dateUpdated":"2021-07-25T17:25:44+0000","dateFinished":"2021-07-25T17:25:45+0000","dateStarted":"2021-07-25T17:25:44+0000","results":{"code":"SUCCESS","msg":[]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1627233944480_951659358","id":"20210725-172544_1321687823","dateCreated":"2021-07-25T17:25:44+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1134"}],"name":"OT-ECO-HW3.2","id":"2GANZZM27","noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}